{% load static tailwind_tags %}

<!DOCTYPE html>
<html>


<head>
        <title>Sign In</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">

        <meta
	    name="htmx-config"
	    content='{
            "responseHandling":[
                {"code":"200", "swap": false},
                {"code":"[23]..", "swap": true},
                {"code":"422", "swap": true},
                {"code":"[45]..", "swap": false, "error":true},
                {"code":"...", "swap": true}
            ]
        }'/>

            <!-- Loading Tailwind and HTMX -->
        {% tailwind_css %}
        {% load static %}
        <script src="{% static 'htmx.min.js' %}"></script>
</head>


<body>


    <form id="login-form"  >

        <div class="w-full min-h-screen flex items-center justify-center"> 
            <fieldset class="fieldset w-xs bg-base-200 border border-base-300 p-4 rounded-box"> <!--hx-target="#error-container"-->
                <legend class="fieldset-legend">Sign In</legend>
                
                <label class="fieldset-label">Username</label>
                <input type="username" id="Username_id" name="username" class="input" placeholder="Username" />
                
                <label class="fieldset-label">Password</label>
                <input type="password" id="Password_id" name="password" class="input" placeholder="Password" />
                
                <button class="btn btn-neutral mt-4" hx-post="/API/sign-in/" hx-include="#Username_id, #Password_id"
                hx-target="#result-container" >
                     Sign In
                </button>
                <div id="result-container"></div>
                <p>Don't have an account yet? <a href="/sign-up" class="font-semibold">Sign Up</a></p>
              </fieldset>
        </div>



        <script>
            document.body.addEventListener("htmx:afterRequest", function(event) {
                if (event.detail.xhr.status === 200) {
                    const redirectUrl = event.detail.xhr.getResponseHeader("HX-Redirect");
                    if (redirectUrl) {
                        window.location.href = redirectUrl; 
                    }
                }
            });
        </script>
</body>
</html>